\documentclass[12pt,a4paper]{article}
\usepackage{hyperref}
\usepackage{graphicx}
\title{Laboratory 2: Unauthorized Access in Wireless Networks}
\author{Niclas Scheuing and Vasileios Dimitrakis}
\begin{document}
\maketitle

\section{Introduction}
	In this laboratory exercise, we learn about and experiment on the weakness in various wireless security mechanisms. More specifically, in the first chapter, we hack the MAC filtering, in the second one, we crack the WEP encryption and in the last part, we break the WPA2 Personal Passwords.

\section{Materials and Methods}
Throughout the lab exercise 2 we used different materials and methods, that are presented below:

\begin{itemize}
	\item \emph{ifconfig}: Is used to configure the network interfaces.
	\item \emph{hostapd}: Is a user space deamon for Access Point and authentication servers.
	\item \emph{iwconfig}: Is used to configure the wireless network interfaces.
	\item \emph{iwlist}: Is used to display some additional information from a wireless network interface that is not displayed by iwconfig
	\item \emph{wireshark}: Is an open source packet analyser.
	\item \emph{macchanger}: Is a Linux command that changes the MAC address of a network interface.
	\item \emph{airodump-ng}: Is used for packet capturing of raw 802.11 frames and is particularly suitable for collecting WEP IVs (Initialization Vector) for the intent of using them with aircrack-ng.
	\item \emph{aircrack-ng}: Is an 802.11 WEP and WPA-PSK keys cracking program that can recover keys once enough data packets have been captured.
	\item \emph{ping}: Is a computer network administration software utility used to test the reachability of a host on an Internet Protocol (IP) network and to measure the round-trip time for messages sent from the originating host to a destination computer and back.
	\item \emph{wpa\_supplicant}: Is a cross-platform supplicant with support for WEP, WPA and WPA2.
	\item \emph{aireplay-ng}: Inject ARP-request packets into a wireless network to generate traffic.
\end{itemize}

\section{Terminology}
The machine serving as wireless nodes is denoted by \emph{User} and the machine used to attack the communication by \emph{Attacker}.
The machine used as access point is called \emph{AP} in the following.


\section{Experiments}
  In the following we will go through the experiments one by one and introduce the corresponding theory, setup and results.
  \subsection{Hacking MAC Filtering}
	  \emph{MAC} filtering is a security technique to prevent unauthorized users from accessing a wireless network.
	  All network devices have a unique 48bit \emph{MAC} address.
	  The access-point grants or denies access to devices based on the \emph{MAC} address communicated by the device itself. This is why a device can spoof the \emph{MAC} address.
	  For filtering black-lists and white-lists are used, granting access to devices contained in the white-list and denying access to those in the black-list.
	  
  \subsubsection{Running the Experiment}
	\emph{AP} used a white-list containing the \emph{User's} \emph{MAC} address, but not the \emph{Attacker's}.
	The \emph{AP} and the \emph{User} were transmitting data.
	The \emph{Attacker} was not able to connect to the \emph{AP}, because he was not on the white-list.
	
	To find the channel and \emph{AP's} \emph{MAC}, the \emph{Attacker} used the \emph{iwlist} tool.
	The \emph{Attacker} is observing the communication running its Wifi adapter in \emph{monitor} mode and capturing the observed traffic with \emph{Wireshark}. This way he was able to extract the \emph{User's} \emph{MAC}. See \autoref{mac:wireshark}
	
	Knowing this \emph{MAC}, the \emph{Attacker} sets his own \emph{MAC} address to the \emph{User's} address using the \emph{macchanger} tool. See \autoref{mac:changer}.
	The \emph{Attacker} \emph{User} were then able to connect to the \emph{AP}.
		
	\begin{figure}
		\includegraphics[width=\textwidth]{"images/other/im3.png}
		\caption{Finding the \emph{User's} \emph{MAC} address using \emph{Wireshark.}}
		\label{mac:wireshark}
	\end{figure}
	
	\begin{figure}
		\includegraphics[width=\textwidth]{"images/other/im4.png}
		\caption{Changing the \emph{Attacker's} \emph{MAC} address using \emph{macchanger.}}
		\label{mac:changer}
	\end{figure}
	\subsubsection{Analysis}
		\emph{MAC} filtering can easily be bypassed with some limitations. The \emph{Attacker} does not get his own \emph{MAC} address, but share it with the \emph{User}, which leads to undesired side effects, such as both receiving the same packages. But it is very easily implemented and in wired networks it is harder for the \emph{Attacker} to sniff valid \emph{MAC} addresses. Also it does not introduce additional overhead which would reduce the networks throughput.
		
  \subsection{Cracking WEP Encryption}
	WEP is security mechanism for wireless networks using a RC4 encryption with a 40bit \emph{secret} concatenated with a 24bit initialization vector. This key is usually represented as a string of 10 hexadecimal values. Besides the initialization vector, there is no additional randomness in the key used for the encryption, because the \emph{secret} remains the same over all transmissions. 24bit is short enough to be brute-forced.
	
	\subsubsection{Running the Experiment}
		\emph{User1} and \emph{User2} connected in ad-hoc mode using a WEP encryption.
		At first they used a different \emph{secret} each, and observed, they were not able to connect. Then they used the same \emph{secret} and could connect.
		
		The \emph{Attacker} who did not set any key, could not connect.
		The \emph{Attacker} did observe the network using the monitor mode and wireshark.
		The packets sniffed using wireshark can be seen in \autoref{wep:wireshark}. It was a flood of ping messages, but encrypted with the WEP's RC4 encryption.
		
		The \emph{Attacker} then started the \emph{airodump-ng} to collect the traffic and \emph{aircrack-ng} tool to crack the key. See \autoref{wep:airodump}.
		It had to capture 38989 initialization vectors and based on that the tool had to try 236 keys to successfully guess the correct one. This took 7 seconds.
		The \emph{Attacker} could then join the network using the found key.
		
		This attack requires a few thousand captured packets. Depending on the network activity, this will take from a few seconds up to 10 minutes.
		
		Observing the traffic in our home network generated by a file server, a multimedia station and a notebook running, we got about 5000 packets per minute. So the attack would take a few minutes.
		
		In a office network with more traffic, this time would be significantly shorter.
		
		
		\begin{figure}
			\includegraphics[width=\textwidth]{images/bill/pic1.png}
			\caption{Capturing the traffic using source \emph{MAC} address filtering.}
			\label{wep:wireshark}
		\end{figure}
		\begin{figure}
			\includegraphics[width=\textwidth]{images/bill/pic3.png}
			\caption{Cracking the WEP key using \emph{aircrack-ng}}
			\label{wep:airodump}
		\end{figure}
		
 \subsection{Breaking WPA2 Personal Passwords }
	\subsubsection{Running the Experiment}

\section{Analysis}
\bibliographystyle{plain}
\bibliography{bibliography}
\end{document}